<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Live Energy Dashboard</title>
  <script src="https://www.gstatic.com/firebasejs/9.24.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.24.0/firebase-database-compat.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-gauges/gauge.min.js"></script>
  <style>
    body { font-family: sans-serif; background: #1f1f2e; color: #fff; }
    .container { display: flex; flex-wrap: wrap; gap: 20px; padding: 20px; }
    .card { background: #2a2a3e; border-radius: 16px; padding: 16px; width: 280px; text-align: center; }
    .card h3 { margin-bottom: 12px; font-size: 18px; color: #ccc; }
  </style>
</head>
<body>
  <h1 style="text-align:center;">Energy Dashboard</h1>
  <div class="container" id="container"></div>

<script>
  const firebaseConfig = {
    apiKey: "dq08PQL2JHCpD13e9295WjatZXFnQOZLCH7Ez4aO",
    databaseURL: "https://esp-983b0-default-rtdb.firebaseio.com/",
    authDomain: "esp-983b0.firebaseapp.com",
    projectId: "esp-983b0"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  const paths = ["Home1","Home2","Home3","compressor","energy_data"]; // you can extend

  const container = document.getElementById('container');

  paths.forEach(path => {
    const card = document.createElement('div');
    card.className = 'card';
    card.innerHTML = `<h3>${path}</h3>
      <canvas id="gauge_${path}" width="240" height="240"></canvas>`;
    container.appendChild(card);

    const gauge = new RadialGauge({
      renderTo: `gauge_${path}`,
      width: 240, height: 240,
      units: "Voltage (V)",
      minValue: 0, maxValue: 300,
      majorTicks: [0,50,100,150,200,250,300],
      minorTicks: 2,
      strokeTicks: true,
      highlights: [ { from: 200, to: 230, color: 'orange' }, { from:230, to:300, color:'red'} ],
      valueBox: true,
      value: 0,
      colorPlate: "#2a2a3e",
      colorMajorTicks: "#fff",
      colorMinorTicks: "#ccc",
      colorNumbers: "#fff",
      colorNeedle: "cyan",
      borderShadowWidth: 0,
      borders: false,
      needleType: "line",
      needleWidth: 3,
      animationDuration: 500,
      animationRule: "linear"
    }).draw();

    db.ref(path + "/voltage").on('value', snap => {
      const v = snap.val();
      if (typeof v === 'number') gauge.value = v;
    });
  });
</script>
</body>
</html>
